namespace = gsm_game_start
event = {
	id = gsm_game_start.1
	hide_window = yes
	is_triggered_only = yes
	immediate = {
    every_country = {
			limit = { 
				is_species_class = gsm_human
				NOT = { has_country_flag = gsm_species_matched }
			}
			owner_species = { save_event_target_as = primary_species_to_match }
			set_country_flag = gsm_species_matched
			
			every_country = {
				limit = { 
					any_owned_pop = { is_same_species_class = event_target:primary_species_to_match }
					NOT = { has_country_flag = gsm_species_matched }
				}
				
				#primary_species
				random_owned_pop = {
					limit = { 
						is_same_species = owner
						is_same_species_class = event_target:primary_species_to_match
					}
					species = {
						set_species_identity = event_target:primary_species_to_match
						this = { save_event_target_as = new_species_matched }
					}
				}
				every_owned_pop = {
					limit = { 
						is_same_species = owner
						is_same_species_class = event_target:primary_species_to_match
					}
					change_species = event_target:new_species_matched
				} 
				every_owned_leader = {
					limit = { 
						is_same_species = owner
						is_same_species_class = event_target:primary_species_to_match
					}
					change_species = event_target:new_species_matched
				}
				every_pool_leader = {
					limit = { 
						is_same_species = owner
						is_same_species_class = event_target:primary_species_to_match
					}
					change_species = event_target:new_species_matched
				}
				change_dominant_species = { species = event_target:new_species_matched }
				
				#secondary species
				random_owned_pop = {
					limit = { 
						NOT = { is_same_species = owner }
						is_same_species_class = event_target:primary_species_to_match
					}
					species = {
						set_species_identity = event_target:primary_species_to_match
						this = { save_event_target_as = new_species_matched }
					}
				}
				every_owned_pop = {
					limit = { 
						NOT = { is_same_species = owner }
						is_same_species_class = event_target:primary_species_to_match
					}
					change_species = event_target:new_species_matched
				}
				set_country_flag = gsm_species_matched
			}
		}
	}
}